<div id="wrapper">
    <div id="page" class="home-1">
        <header id="header_main" class="header_1 header-fixed">
            <div class="themesflat-container">
                <div class="row">
                    <div class="col-md-12">                              
                        <div id="site-header-inner"> 
                            <div class="wrap-box flex">
                                <div id="site-logo">
                                    <div *ngIf="activeWallet">
                                        <a [routerLink]="['/tabs/home']" (click)="closeMobileNav()" rel="home" class="main-logo">
                                          <img [src]="profile.avatar" alt="avatar" style="height: 40px;border-radius: 10px;" />
                                        </a>
                                        <span class="wallet-address">{{ shorten(activeWallet) }}</span>
                                    </div>
                                    <div *ngIf="!activeWallet">
                                        <a [routerLink]="['/login']" class="tf-button style-1">
                                            <span>Login / Signup</span>
                                        </a>
                                    </div>
                                </div><!-- logo -->
                                <div class="mobile-button" *ngIf="activeWallet" (click)="toggleMobileNav()">
                                    <span></span>
                                </div><!-- /.mobile-button -->
                            </div> 
                        </div>
                    </div>
                </div>
            </div>
            <div class="mobile-nav-wrap" [class.active]="mobileNavActive">
                <div class="overlay-mobile-nav" (click)="closeMobileNav()"></div>
                <div class="inner-mobile-nav">
                    <a [routerLink]="['/tabs/home']" (click)="closeMobileNav()" rel="home" class="main-logo">
                        <img [src]="profile.avatar" alt="avatar" style="width: 30%;border-radius: 10px;" />
                    </a>

                    <!-- tombol close -->
                    <div class="mobile-nav-close" (click)="closeMobileNav()">
                        <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" fill="white" x="0px" y="0px" width="20px" height="20px" viewBox="0 0 122.878 122.88" enable-background="new 0 0 122.878 122.88" xml:space="preserve"><g><path d="M1.426,8.313c-1.901-1.901-1.901-4.984,0-6.886c1.901-1.902,4.984-1.902,6.886,0l53.127,53.127l53.127-53.127 c1.901-1.902,4.984-1.902,6.887,0c1.901,1.901,1.901,4.985,0,6.886L68.324,61.439l53.128,53.128c1.901,1.901,1.901,4.984,0,6.886 c-1.902,1.902-4.985,1.902-6.887,0L61.438,68.326L8.312,121.453c-1.901,1.902-4.984,1.902-6.886,0 c-1.901-1.901-1.901-4.984,0-6.886l53.127-53.128L1.426,8.313L1.426,8.313z"/></g></svg>
                    </div>

                    <!-- menu -->
                    <nav id="mobile-main-nav" class="mobile-main-nav">
                        <ul id="menu-mobile-menu" class="menu">
                            <li class="menu-item" *ngFor="let w of uniqueWallets" 
                                [ngClass]="{ 'current-item': w.address === activeWallet }">
                                <a class="item-menu-mobile flex-between">
                                    <span (click)="switchWallet(w.address); closeMobileNav()">{{ shorten(w.address) }}</span>
                                    <span class="wallet-balance">
                                        ${{ w.usdValue | number:'1.2-2' }}
                                    </span>
                                    <ion-icon 
                                        name="copy-outline"
                                        (click)="onCopyIconClick($event, w.address)">
                                    </ion-icon>
                                </a>
                            </li>

                            <li class="menu-item" *ngIf="activeWallet">
                                <a class="item-menu-mobile" (click)="toggleAccountsModal(); closeMobileNav()">
                                    Add Accounts
                                </a>
                            </li>

                            <li class="menu-item" *ngIf="activeWallet">
                                <a class="item-menu-mobile" [routerLink]="['/market-layout/setting']" (click)="closeMobileNav()">
                                    Settings
                                </a>
                            </li>

                              <li class="menu-item" *ngIf="activeWallet">
                                  <a class="item-menu-mobile" (click)="logout()">
                                      Logout
                                  </a>
                              </li>
                        </ul>
                    </nav>
                </div>
            </div>
        </header>

        <!-- Modal Accounts -->
        <div class="custom-modal" *ngIf="showAccountsModal">
            <div class="modal-backdrop" (click)="resetAccountsModal()"></div>
            <div class="modal-sheet" [ngClass]="{ 'slide-up': !isClosingAccounts, 'slide-down': isClosingAccounts }">

              <!-- Step 1: Pilihan utama -->
              <div *ngIf="!selectedAccountAction">
                <h2 class="modal-title">Add Account</h2>

                <div class="widget-table-ranking pb-20">

                  <!-- Create Account -->
                  <div class="table-ranking-content" (click)="selectAccountAction('create')">
                    <div class="fl-row-ranking">
                      <div class="td1">
                        <div class="item-avatar">
                          <ion-icon name="add-circle-outline"></ion-icon>
                        </div>
                        <div class="item-name">
                          Create New Account
                          <p class="price gem pt-10">Add a new custodial account</p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Import Recovery Phrase -->
                  <div class="table-ranking-content" (click)="selectAccountAction('phrase')">
                    <div class="fl-row-ranking">
                      <div class="td1">
                        <div class="item-avatar">
                          <ion-icon name="document-text-outline"></ion-icon>
                        </div>
                        <div class="item-name">
                          Import Recovery Phrase
                          <p class="price gem pt-10">Import from seed phrase</p>
                        </div>
                      </div>
                    </div>
                  </div>

                  <!-- Import Private Key -->
                  <div class="table-ranking-content" (click)="selectAccountAction('private')">
                    <div class="fl-row-ranking">
                      <div class="td1">
                        <div class="item-avatar">
                          <ion-icon name="key-outline"></ion-icon>
                        </div>
                        <div class="item-name">
                          Import Private Key
                          <p class="price gem pt-10">Import a single-chain account</p>
                        </div>
                      </div>
                    </div>
                  </div>

                </div>

                <div class="modal-actions">
                  <button type="button" class="btn-cancel" (click)="resetAccountsModal()">Cancel</button>
                </div>
              </div>

              <!-- Step 2a: Create Account -->
              <div *ngIf="selectedAccountAction === 'create'">
                <h2 class="modal-title">Create New Account</h2>
                <p>This will generate a new custodial wallet linked to your user ID.</p>

                <div class="modal-actions">
                  <button class="btn-cancel" (click)="selectedAccountAction = null">Back</button>
                  <button class="btn-send" (click)="addCustodialAccount()">Create</button>
                </div>
              </div>

              <!-- Step 2b: Import Phrase -->
              <div *ngIf="selectedAccountAction === 'phrase'">
                <h2 class="modal-title">Import Recovery Phrase</h2>
                <form (submit)="importRecoveryPhrase($event)">
                  <textarea
                    [(ngModel)]="recoveryPhrase"
                    name="recoveryPhrase"
                    placeholder="Enter your 12/24-word phrase"
                    class="search-field style-1"
                    rows="3"
                    required>
                  </textarea>
                  <div class="modal-actions pt-20">
                    <button class="btn-cancel" (click)="selectedAccountAction = null">Back</button>
                    <button type="submit" class="btn-send">Import</button>
                  </div>
                </form>
              </div>

              <!-- Step 2c: Import Private Key -->
              <div *ngIf="selectedAccountAction === 'private'">
                <h2 class="modal-title">Import Private Key</h2>
                <form (submit)="importPrivateKey($event)">
                  <input
                    type="text"
                    [(ngModel)]="privateKey"
                    name="privateKey"
                    placeholder="Enter your private key"
                    class="search-field style-1"
                    required>
                  <div class="modal-actions pt-20">
                    <button class="btn-cancel" (click)="selectedAccountAction = null">Back</button>
                    <button type="submit" class="btn-send">Import</button>
                  </div>
                </form>
              </div>

            </div>
        </div>
    </div>
</div>

<ion-tabs>
    <ion-tab-bar slot="bottom" class="bottom-tab-bar">
        <ion-tab-button tab="all-collection" [routerLink]="['/market-layout/all-collection']" routerLinkActive="active">
            <ion-icon name="storefront-outline"></ion-icon>
            <!-- <ion-label>All</ion-label> -->
        </ion-tab-button>

        <ion-tab-button tab="my-nfts" [routerLink]="['/market-layout/my-nfts']" routerLinkActive="active">
            <ion-icon name="grid-outline"></ion-icon>
            <!-- <ion-label>My NFT</ion-label> -->
        </ion-tab-button>

        <ion-tab-button tab="creates" [routerLink]="['/market-layout/creates']" routerLinkActive="active">
            <ion-icon name="duplicate-outline"></ion-icon>
            <!-- <ion-label>Creates</ion-label> -->
        </ion-tab-button>

        <ion-tab-button tab="my-favorite" [routerLink]="['/market-layout/my-favorite']" routerLinkActive="active">
            <ion-icon name="heart-outline"></ion-icon>
            <!-- <ion-label>Favorite</ion-label> -->
        </ion-tab-button>

        <ion-tab-button tab="transactions" [routerLink]="['/market-layout/transactions']" routerLinkActive="active">
            <ion-icon name="time-outline"></ion-icon>
            <!-- <ion-label>History</ion-label> -->
        </ion-tab-button>
    </ion-tab-bar>

</ion-tabs>